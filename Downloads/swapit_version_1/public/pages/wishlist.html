<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wishlist — SwapIt</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css" />
  <script src="../assets/js/auth-client.js"></script>
  <script src="../assets/js/nav-manager.js"></script>
  <style>
    .wishlist-item {
      display: flex;
      gap: 20px;
      padding: 20px;
      background: #11131a;
      border: 1px solid #1e2434;
      border-radius: 12px;
      margin-bottom: 16px;
      align-items: center;
    }
    .wishlist-item img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 8px;
    }
    .wishlist-item-details {
      flex: 1;
    }
    .wishlist-item-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .wishlist-item-price {
      color: #7ef9ff;
      font-size: 1.1rem;
      font-weight: 600;
    }
    .wishlist-item-actions {
      display: flex;
      gap: 10px;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <header class="nav" id="siteHeader">
    <div class="container nav__bar">
      <a class="logo" href="home.html" style="display:flex;align-items:center;gap:8px"><img src="../assets/images/logo.png" alt="SwapIt Logo" style="width:40px;height:40px;border-radius:50%;object-fit:cover"><span><span>SWAP</span>IT</span></a>
      <nav class="nav__menu">
        <a href="home.html">Home</a>
        <a href="browse.html">Browse</a>
      </nav>
      <div class="nav__cta">
        <div class="nav__search">
          <i class="fas fa-search"></i>
          <input type="search" id="navSearch" placeholder="Search items..." aria-label="Search items">
        </div>
        <div class="nav__auth" style="display:flex;gap:16px;align-items:center">
          <div class="account-dropdown">
            <button class="btn btn--primary account-dropdown-btn" onclick="toggleAccountDropdown(event)">
              <i class="fas fa-user"></i>
              Account
              <i class="fas fa-chevron-down"></i>
            </button>
            <div class="account-dropdown-menu">
              <a href="login.html"><i class="fas fa-sign-in-alt"></i> Login</a>
              <a href="signup.html"><i class="fas fa-user-plus"></i> Sign Up</a>
            </div>
          </div>
          <a href="wishlist.html" class="wishlist-widget" style="position:relative;display:flex;flex-direction:column;align-items:center;text-decoration:none;color:#fff">
            <i class="fas fa-heart" style="font-size:1.3rem;color:#ff7df2"></i>
            <span style="font-size:0.65rem;font-weight:600;margin-top:2px">Wishlist</span>
            <span id="wishlistCount" style="position:absolute;top:-6px;right:-6px;background:#ff7df2;color:#fff;border-radius:50%;width:18px;height:18px;display:none;align-items:center;justify-content:center;font-size:0.65rem;font-weight:700">0</span>
          </a>
          <a href="cart.html" class="cart-widget" style="position:relative;display:flex;flex-direction:column;align-items:center;text-decoration:none;color:#fff">
            <i class="fas fa-shopping-cart" style="font-size:1.3rem;color:#7ef9ff"></i>
            <span style="font-size:0.65rem;font-weight:600;margin-top:2px">Cart</span>
            <span id="cartCount" style="position:absolute;top:-6px;right:-6px;background:#ff7df2;color:#fff;border-radius:50%;width:18px;height:18px;display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:700">0</span>
          </a>
        </div>
        <button class="nav__toggle" id="navToggle" aria-label="Open menu" aria-expanded="false">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>
    <div class="nav__drawer" id="navDrawer" aria-label="Mobile" data-open="false">
      <a href="../index.html">Home</a>
      <a href="../index.html#how">How it works</a>
      <a href="../index.html#stories">Stories</a>
      <a href="../index.html#about-us">About Us</a>
      <a href="../index.html#pricing">Pricing</a>
      <a href="../index.html#faq">FAQ</a>
      <a href="browse.html">Browse</a>
      <div class="nav__search">
        <i class="fas fa-search"></i>
        <input type="search" placeholder="Search items..." aria-label="Search items">
      </div>
      <div class="nav__auth">
        <a class="btn btn--outline w-100 mb-2" href="login.html">Log in</a>
        <a class="btn btn--primary w-100" href="signup.html">Sign up</a>
      </div>
    </div>
  </header>

  <div class="container" style="padding:48px 16px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem">
      <h1>Your Wishlist</h1>
      <span id="wishlistTotal" style="color:#9aa5c3;font-size:1rem">0 items</span>
    </div>
    
    <div id="wishlistList">
      <!-- Dynamic content loaded via JavaScript -->
    </div>

    <div style="margin-top:24px">
      <a href="browse.html" class="btn btn--ghost">Continue browsing</a>
    </div>
  </div>

  <footer class="sitefoot">
    <div class="container">
      <div class="sitefoot__bottom">
        <div style="display:flex;align-items:center;justify-content:center;gap:8px;width:100%">
          <img src="../assets/images/logo.png" alt="SwapIt Logo" style="width:32px;height:32px;border-radius:50%;object-fit:cover">
          <small>SwapIt Ltd. &copy; All rights reserved <span id="year">2025</span></small>
        </div>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    
    /**
     * Toggle account dropdown menu visibility
     */
    function toggleAccountDropdown(event) {
      if (event) {
        event.stopPropagation();
      }
      const dropdown = document.querySelector('.account-dropdown');
      if (dropdown) {
        dropdown.classList.toggle('active');
      }
    }
    
    /**
     * Close dropdown when user clicks outside
     */
    document.addEventListener('click', function(event) {
      const dropdown = document.querySelector('.account-dropdown');
      if (dropdown && !dropdown.contains(event.target)) {
        dropdown.classList.remove('active');
      }
    });
  </script>
  <script src="../assets/js/script.js"></script>
  <script src="../assets/js/cart.js"></script>
  <script>
    /**
     * Renders the wishlist items from localStorage
     */
    function renderWishlist() {
      const wishlist = JSON.parse(localStorage.getItem('swapit_wishlist')||'[]');
      const container = document.getElementById('wishlistList');
      const totalSpan = document.getElementById('wishlistTotal');
      
      container.innerHTML = '';
      totalSpan.textContent = wishlist.length + ' item' + (wishlist.length !== 1 ? 's' : '');
      
      if (!wishlist.length) {
        container.innerHTML = '<p style="text-align:center;color:#9aa5c3;padding:40px 0">Your wishlist is empty. Start browsing to add items!</p>';
        return;
      }
      
      wishlist.forEach((item, index) => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'wishlist-item';
        
        itemDiv.innerHTML = `
          <img src="${item.img}" alt="${item.title}">
          <div class="wishlist-item-details">
            <div class="wishlist-item-title">${item.title}</div>
            <p style="color:#9aa5c3;margin:8px 0">${item.location || 'Location not specified'}</p>
            <div class="wishlist-item-price">${item.price > 0 ? 'GHS ' + item.price + '/day' : 'Free'}</div>
          </div>
          <div class="wishlist-item-actions">
            <button class="btn btn--primary add-to-cart-btn" data-index="${index}" style="padding:10px 20px;white-space:nowrap">
              <i class="fas fa-shopping-cart"></i> Add to Cart
            </button>
            <button class="btn btn--ghost remove-btn" data-index="${index}" style="padding:10px 20px">
              <i class="fas fa-trash"></i> Remove
            </button>
          </div>
        `;
        
        container.appendChild(itemDiv);
      });
      
      // Attach remove button event handlers
      document.querySelectorAll('.remove-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(e.currentTarget.dataset.index);
          let wishlist = JSON.parse(localStorage.getItem('swapit_wishlist')||'[]');
          const removedItem = wishlist[index];
          wishlist.splice(index, 1);
          localStorage.setItem('swapit_wishlist', JSON.stringify(wishlist));
          
          if (window.showNotification) {
            window.showNotification(removedItem.title + ' removed from wishlist');
          }
          if (window.updateWishlistCount) window.updateWishlistCount();
          window.dispatchEvent(new Event('storage'));
          renderWishlist();
        });
      });
      
      /**
       * Attach add-to-cart button event handlers
       */
      document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const index = parseInt(e.currentTarget.dataset.index);
          const wishlist = JSON.parse(localStorage.getItem('swapit_wishlist')||'[]');
          const item = wishlist[index];
          
          const cart = JSON.parse(localStorage.getItem('swapit_cart')||'[]');
          const exists = cart.find(c=>c.id === item.id);
          if (exists) {
            exists.qty = (exists.qty||1) + 1;
          } else {
            item.qty = 1;
            cart.push(item);
          }
          localStorage.setItem('swapit_cart', JSON.stringify(cart));
          
          if (window.showNotification) {
            window.showNotification(item.title + ' added to cart!');
          }
          if (window.updateCartCount) window.updateCartCount();
          window.dispatchEvent(new Event('storage'));
        });
      });
    }
    
    /**
     * Display wishlist on page load
     */
    renderWishlist();
    
    /**
     * Re-render when localStorage changes (cross-tab sync)
     */
    window.addEventListener('storage', renderWishlist);
  </script>
</body>
</html>
